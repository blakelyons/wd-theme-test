/*!
 * Autoplay Embedded Videos on Scroll into Viewport v1.0.0
 * https://accrisoft.com
 * Copyright 2023 Accrisoft
 */

var ytPlayerList=[],ytPlayers={},ytIframePlayerReady=!1,vimeoPlayerList=[],vimeoPlayers={},vimeoIframePlayerReady=!1,ytErrors=[],vimeoErrors=[];const initYouTubeAPI=async()=>{var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(e,o)},createYouTubePlayer=e=>new YT.Player(e,{videoId:e,playerVars:{showinfo:0,playsInline:1,loop:1,controls:1,disablekb:1,mute:1},events:{onReady:checkYouTubePlayerReady}}),checkYouTubePlayerReady=()=>{ytIframePlayerReady=!0,startObserving(".youTubePlayerIframe")};async function onYouTubeIframeAPIReady(){await getVideoPlayersList("youtube"),initValidation(ytPlayerList,"youtube"),ytErrors.length>0||ytPlayerList.forEach((async e=>{console.log(`forEach YT Player: ${e.id}`);const o=(a=e.id,new YT.Player(a,{videoId:a,playerVars:{showinfo:0,playsInline:1,loop:1,controls:1,disablekb:1,mute:1},events:{onReady:checkYouTubePlayerReady}}));var a;ytPlayers[e.id]=o}))}const playYouTubeVideo=e=>{ytIframePlayerReady?ytPlayers[e]?"function"==typeof ytPlayers[e].playVideo?ytPlayers[e].playVideo():console.error(`playVideo method not available for Player ID: ${e}`):console.error(`Player ID ${e} not found`):console.error("YouTube iframe player is not ready")},pauseYouTubeVideo=e=>{ytIframePlayerReady?ytPlayers[e]?"function"==typeof ytPlayers[e].pauseVideo?ytPlayers[e].pauseVideo():console.error(`pauseVideo method not available for Player ID: ${e}`):console.error(`Player ID ${e} not found`):console.error("YouTube iframe player is not ready")};var tag=document.createElement("script");tag.src="https://player.vimeo.com/api/player.js";var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag),console.log("Vimeo API Initialized");const createVimeoPlayers=async e=>{console.log("Creating Vimeo Video");let o=document.querySelectorAll(e);o.forEach((async e=>{var a=e.id,r=new Vimeo.Player(e,{id:a,muted:!0,autoplay:!1,controls:!0}).ready((()=>{console.log("Vimeo Video Embed is Ready")})).catch((e=>{vimeoErrors.push(`ERROR: ${e}`)}));await initValidation(o,"vimeo",vimeoErrors),e.dataset.vimeoPlayer=r,await checkVimeoPlayerReady(),startObserving(".vimeoPlayerIframe")}))},checkVimeoPlayerReady=async()=>{console.log("checkVimeoPlayerReady"),vimeoIframePlayerReady=!0},playVimeoVideo=e=>{if(vimeoIframePlayerReady){let o=document.getElementById(e);new Vimeo.Player(o,{id:e,muted:!0,autoplay:!1,controls:!0}).play()}else console.error("Vimeo iframe player is not ready")},pauseVimeoVideo=e=>{if(vimeoIframePlayerReady){let o=document.getElementById(e);new Vimeo.Player(o,{id:e,muted:!0,autoplay:!1,controls:!0}).pause()}else console.error("Vimeo iframe player is not ready")},getVideoPlayersList=async e=>{"youtube"==e&&document.querySelectorAll(".youTubePlayerIframe").forEach((e=>{ytPlayerList.push({id:e.id,videoId:e.id})})),"vimeo"==e&&document.querySelectorAll(".vimeoPlayerIframe").forEach((e=>{vimeoPlayerList.push({id:e.id,videoId:e.id})}))},initValidation=async(e,o,a)=>{const r=new Set;let t=null;e.forEach((e=>{r.has(e.id)?("youtube"==o&&(ytErrors.push(e.id),t=document.querySelectorAll(`[data-youtube-id="${e.id}"]`)),"vimeo"==o&&(vimeoErrors.push(...a,e.id),t=document.querySelectorAll(`[data-vimeo-id="${e.id}"]`)),t.forEach((a=>{a.innerHTML=`<span style="display: inline-block; color: red; border: 1px solid red; margin: 1rem 0; padding: 1rem;"><b>ERROR: Duplicate ${"youtube"==o?"YouTube":"Vimeo"} Player ID:</b> ${e.id}</span>`}))):r.add(e.id)}))},createVideoPlayerIframes=async e=>{if("youtube"==e&&0==document.querySelectorAll(".youTubeVideoIframe").length)return void console.error("No YouTube Video Iframes Found");if("vimeo"==e&&0==document.querySelectorAll(".vimeoVideoIframe").length)return void console.error("No Vimeo Video Iframes Found");let o=null;if("youtube"==e){o=document.querySelectorAll(".youTubeVideoIframe")}if("vimeo"==e){o=document.querySelectorAll(".vimeoVideoIframe")}for(const a of o){let o=a.querySelector("p").innerText,r=a.querySelector("p").classList,t=document.createElement("p");r.length>0&&t.classList.add(r),a.removeChild(a.querySelector("*"));let i=document.createElement("div");i.id=o,"youtube"==e&&(i.classList.add("youTubePlayerIframe"),t.appendChild(i),t.classList.add("youTubePlayer"),t.setAttribute("data-youtube-id",o)),"vimeo"==e&&(i.classList.add("vimeoPlayerIframe"),t.appendChild(i),t.classList.add("vimeoPlayer"),t.setAttribute("data-vimeo-id",o)),a.replaceWith(t)}"youtube"==e&&await initYouTubeAPI(),"vimeo"==e&&(await createVimeoPlayers(".vimeoPlayerIframe"),checkVimeoPlayerReady())},startObserving=async e=>{console.log(`Start Observing: ${e}`);document.querySelectorAll(e).forEach((async e=>{setupObserver(e)}))},setupObserver=async e=>{new IntersectionObserver((e=>{e.forEach((e=>{var o;e.isIntersecting?(console.log(`Entry Target Class: ${e.target.className}`),"youTubePlayerIframe"==e.target.className&&(o=e.target.id,ytIframePlayerReady?ytPlayers[o]?"function"==typeof ytPlayers[o].playVideo?ytPlayers[o].playVideo():console.error(`playVideo method not available for Player ID: ${o}`):console.error(`Player ID ${o} not found`):console.error("YouTube iframe player is not ready")),"vimeoPlayerIframe"==e.target.className&&playVimeoVideo(e.target.id)):("youTubePlayerIframe"==e.target.className&&pauseYouTubeVideo(e.target.id),"vimeoPlayerIframe"==e.target.className&&pauseVimeoVideo(e.target.id))}))}),{threshold:.8}).observe(e)};$(window).on("load",(async function(){await createVideoPlayerIframes("youtube"),await createVideoPlayerIframes("vimeo")}));